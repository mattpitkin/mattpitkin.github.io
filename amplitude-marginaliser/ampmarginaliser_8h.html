<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Amplitude Marginaliser: src/ampmarginaliser.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Amplitude Marginaliser
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">src/ampmarginaliser.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A set of functions for analytically marginalising a Gaussian likelihood ratio over signal model component amplitudes.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_math.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_sf_erf.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_randist.h&gt;</code><br/>
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br/>
</div>
<p><a href="ampmarginaliser_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#ab6f7bd4382472f906821526216a9939f">AM_SQUARE</a>(x)&#160;&#160;&#160;(x*x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#aa48dcc9cf0463d91b0162b4ee319cc60">AM_LN2PI</a>&#160;&#160;&#160;(M_LN2 + M_LNPI)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a719d196420a571f6eebdc80e375fae12">AM_LNPI_2</a>&#160;&#160;&#160;(M_LNPI - M_LN2)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f">marginalise_amplitudes</a> (int Nmodels, double **modelModel, double *dataModel, double sigma, unsigned int lastHalfRange)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components.  <a href="#a0866718fbad645ebe568f10ac108470f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56078daf0afc8328bd9f2b7c4dfaabb7"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes_f" ref="a56078daf0afc8328bd9f2b7c4dfaabb7" args="(int Nmodels, float **modelModel, float *dataModel, float sigma, unsigned int lastHalfRange)" -->
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a56078daf0afc8328bd9f2b7c4dfaabb7">marginalise_amplitudes_f</a> (int Nmodels, float **modelModel, float *dataModel, float sigma, unsigned int lastHalfRange)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The same as <code><a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f" title="Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components...">marginalise_amplitudes()</a></code>, but for <code>float</code> inputs rather than <code>double</code>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a521f5acbf28df7ce261996914f50e5b6">marginalise_amplitudes_except_final</a> (int Nmodels, double **modelModel, double *dataModel, double sigma)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Marginalise over all amplitudes except for the final model component.  <a href="#a521f5acbf28df7ce261996914f50e5b6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0c7539a9c7ddb68502538803a5d12774"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes_except_final_f" ref="a0c7539a9c7ddb68502538803a5d12774" args="(int Nmodels, float **modelModel, float *dataModel, float sigma)" -->
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a0c7539a9c7ddb68502538803a5d12774">marginalise_amplitudes_except_final_f</a> (int Nmodels, float **modelModel, float *dataModel, float sigma)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The same as <code><a class="el" href="ampmarginaliser_8c.html#a521f5acbf28df7ce261996914f50e5b6" title="Marginalise over all amplitudes except for the final model component.">marginalise_amplitudes_except_final()</a></code>, but for <code>float</code> inputs rather than <code>double</code>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36d1fe12fd6e9ffbfbfbaa646218a065"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes_linear" ref="a36d1fe12fd6e9ffbfbfbaa646218a065" args="(int Nmodels, double modelModel[], double dataModel[], double sigma, unsigned int lastHalfRange)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a36d1fe12fd6e9ffbfbfbaa646218a065">marginalise_amplitudes_linear</a> (int Nmodels, double modelModel[], double dataModel[], double sigma, unsigned int lastHalfRange)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The same as <code><a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f" title="Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components...">marginalise_amplitudes()</a></code>, but with the <code>modelModel</code> array made into a 1D vector rather than a 2D array. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17a52264ea5462ea9f5de162fa52a372"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes_except_final_linear" ref="a17a52264ea5462ea9f5de162fa52a372" args="(int Nmodels, double modelModel[], double dataModel[], double sigma)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a17a52264ea5462ea9f5de162fa52a372">marginalise_amplitudes_except_final_linear</a> (int Nmodels, double modelModel[], double dataModel[], double sigma)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The same as <code><a class="el" href="ampmarginaliser_8c.html#a521f5acbf28df7ce261996914f50e5b6" title="Marginalise over all amplitudes except for the final model component.">marginalise_amplitudes_except_final()</a></code>, but with the <code>modelModel</code> array made into a 1D vector rather than a 2D array. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#af13a6e01f40f5e8ffb5ff350f9a45869">marginalise_three_amplitudes</a> (double **modelModel, double *dataModel, double sigma, unsigned int lastHalfRange)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the likelihood ratio marginalisation explicitly written out for the model amplitude components.  <a href="#af13a6e01f40f5e8ffb5ff350f9a45869"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a12a573ef8736525a8f486a980afd6fbd"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_three_amplitudes_f" ref="a12a573ef8736525a8f486a980afd6fbd" args="(float **modelModel, float *dataModel, float sigma, unsigned int lastHalfRange)" -->
float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a12a573ef8736525a8f486a980afd6fbd">marginalise_three_amplitudes_f</a> (float **modelModel, float *dataModel, float sigma, unsigned int lastHalfRange)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The same as <code><a class="el" href="ampmarginaliser_8c.html#af13a6e01f40f5e8ffb5ff350f9a45869" title="Performs the likelihood ratio marginalisation explicitly written out for the model amplitude componen...">marginalise_three_amplitudes()</a></code>, but for <code>float</code> inputs rather than <code>double</code>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ampmarginaliser_8h.html#a5fa96fe701a1d244b62ddcc51a316a5c">marginalise_three_amplitudes_exclude_final</a> (double **modelModel, double *dataModel, double sigma)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Explicitly marginalise over the first three model component amplitudes, but not the final one.  <a href="#a5fa96fe701a1d244b62ddcc51a316a5c"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>A set of functions for analytically marginalising a Gaussian likelihood ratio over signal model component amplitudes. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa48dcc9cf0463d91b0162b4ee319cc60"></a><!-- doxytag: member="ampmarginaliser.h::AM_LN2PI" ref="aa48dcc9cf0463d91b0162b4ee319cc60" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="ampmarginaliser_8h.html#aa48dcc9cf0463d91b0162b4ee319cc60">AM_LN2PI</a>&#160;&#160;&#160;(M_LN2 + M_LNPI)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><img class="formulaInl" alt="$ \ln{(2\pi)} $" src="form_20.png"/> using <a href="https://www.gnu.org/software/gsl/manual/html_node/Mathematical-Constants.html">GSL constants</a> </p>

</div>
</div>
<a class="anchor" id="a719d196420a571f6eebdc80e375fae12"></a><!-- doxytag: member="ampmarginaliser.h::AM_LNPI_2" ref="a719d196420a571f6eebdc80e375fae12" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="ampmarginaliser_8h.html#a719d196420a571f6eebdc80e375fae12">AM_LNPI_2</a>&#160;&#160;&#160;(M_LNPI - M_LN2)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><img class="formulaInl" alt="$ \ln{(\pi/2)} $" src="form_21.png"/> </p>

</div>
</div>
<a class="anchor" id="ab6f7bd4382472f906821526216a9939f"></a><!-- doxytag: member="ampmarginaliser.h::AM_SQUARE" ref="ab6f7bd4382472f906821526216a9939f" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="ampmarginaliser_8h.html#ab6f7bd4382472f906821526216a9939f">AM_SQUARE</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(x*x)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The square of <code>x</code> </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0866718fbad645ebe568f10ac108470f"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes" ref="a0866718fbad645ebe568f10ac108470f" args="(int Nmodels, double **modelModel, double *dataModel, double sigma, unsigned int lastHalfRange)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f">marginalise_amplitudes</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nmodels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>modelModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dataModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>lastHalfRange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components. </p>
<p>Function to marginalise over the amplitudes for each of the model components, where there can be an arbitrary number of models. In general all the amplitudes are marginalised between <img class="formulaInl" alt="$-\infty$" src="form_14.png"/> and <img class="formulaInl" alt="$\infty$" src="form_15.png"/>, although if specified the final model component amplitude will be marginalised between 0 and <img class="formulaInl" alt="$\infty$" src="form_15.png"/> i.e. it's a purely positive model.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">Nmodels</td><td>- the number of components of the signal model with separate amplitudes </td></tr>
    <tr><td class="paramname">modelModel</td><td>- a 2D array containing the sums of the model cross products from the likelihood e.g. for three model components (see <a class="el" href="index.html#sec_desc">Description</a>) <img class="formulaInl" alt="$f$" src="form_22.png"/>, <img class="formulaInl" alt="$g$" src="form_23.png"/>, <img class="formulaInl" alt="$h$" src="form_24.png"/>, this should contain: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \begin{array}{c c c} \sum_i f_i^2 &amp; \sum_i f_i g_i &amp; \sum_i f_i h_i \\ 0 &amp; \sum_i g_i^2 &amp; \sum_i g_i h_i \\ 0 &amp; 0 &amp; \sum_i h_i^2 \end{array} \right) \]" src="form_25.png"/>
</p>
 </td></tr>
    <tr><td class="paramname">dataModel</td><td>- a 1D array containing the sums of the product of the data, <img class="formulaInl" alt="$d$" src="form_26.png"/>, with each model component from the likelihood e.g. <img class="formulaInl" alt="${\sum_i d_i f_i, \sum_i d_i g_i, \sum_i d_i h_i}$" src="form_27.png"/>. </td></tr>
    <tr><td class="paramname">sigma</td><td>- the noise standard deviation of the data. </td></tr>
    <tr><td class="paramname">lastHalfRange</td><td>- if this is set to 1 the final model component will be marginalised between 0 and infinity rather than the default of -infinity to infinity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>logL - the natural logarithm of the marginalised likelihood ratio.</dd></dl>
<p>Note: this function does not apply priors to the marginalised amplitudes, but flat prior values could be applied afterwards provided the likelihoods have approached zero towards the edges of the prior range. </p>

</div>
</div>
<a class="anchor" id="a521f5acbf28df7ce261996914f50e5b6"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_amplitudes_except_final" ref="a521f5acbf28df7ce261996914f50e5b6" args="(int Nmodels, double **modelModel, double *dataModel, double sigma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="ampmarginaliser_8h.html#a521f5acbf28df7ce261996914f50e5b6">marginalise_amplitudes_except_final</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nmodels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>modelModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dataModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Marginalise over all amplitudes except for the final model component. </p>
<p>This function allows for a model that contains components for which the amplitudes are required to be marginalisation over, and also a component (which could contain multiple components defined by various parameters itself) for which no marginalisation is required. It follows the same route as for <code><a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f" title="Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components...">marginalise_amplitudes()</a></code>, but stops before the final marginalisation.</p>
<p>All the amplitude marginalisations are performed over the <img class="formulaInl" alt="${-\infty, \infty}$" src="form_28.png"/> range. </p>

</div>
</div>
<a class="anchor" id="af13a6e01f40f5e8ffb5ff350f9a45869"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_three_amplitudes" ref="af13a6e01f40f5e8ffb5ff350f9a45869" args="(double **modelModel, double *dataModel, double sigma, unsigned int lastHalfRange)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="ampmarginaliser_8h.html#af13a6e01f40f5e8ffb5ff350f9a45869">marginalise_three_amplitudes</a> </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>modelModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dataModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>lastHalfRange</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the likelihood ratio marginalisation explicitly written out for the model amplitude components. </p>
<p>For three amplitudes the marginalised likelihood ratio is given by: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathcal{L} = (2\pi)^{3/2}\sigma^3 \frac{e^{-\frac{ d_h^2(f_g^2-FG) -2d_h(d_g f_g f_h - d_f f_h G -d_g F g_h + d_f f_g g_h) + d_g^2(f_h^2 - FH) + 2d_f d_g(f_g H - f_h g_h) + d_f^2(g_h^2 - GH)}{2\sigma^2 (FGH + 2f_g f_h g_h -G f_h^2 - H f_g^2 - F g_h^2) }}}{\sqrt{F}\sqrt{\frac{(FG - f_g^2)}{F}}\sqrt{\frac{FGH + 2f_g f_h g_h -G f_h^2 - F g_h^2 - H f_g^2}{FG - f_g^2}}} \]" src="form_40.png"/>
</p>
<p> for an integral between <img class="formulaInl" alt="${-\infty, \infty}$" src="form_28.png"/> for all amplitudes, and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \mathcal{L} =&amp; \sqrt{2}\pi^{3/2}\sigma^3 \frac{e^{-\frac{ d_h^2(f_g^2-FG) -2d_h(d_g f_g f_h - d_f f_h G -d_g F g_h + d_f f_g g_h) + d_g^2(f_h^2 - FH) + 2d_f d_g(f_g H - f_h g_h) + d_f^2(g_h^2 - GH)}{2\sigma^2 (FGH + 2f_g f_h g_h -G f_h^2 - H f_g^2 - F g_h^2) }}}{\sqrt{F}\sqrt{\frac{(FG - f_g^2)}{F}}\sqrt{\frac{FGH + 2f_g f_h g_h -G f_h^2 - F g_h^2 - H f_g^2}{FG - f_g^2}}} \times \\ &amp; \left( 1 + {\rm erf}\left( \frac{d_f f_g g_h + d_g f_g f_h + FG d_h - G d_f f_h - F d_g g_h - d_g f_g^2}{\sqrt{2}\sigma(FG-f_g^2)\sqrt{\frac{FGH + 2f_g f_h g_h - F g_h^2 - G f_h^2 - h f_g^2}{FG-f_g^2}}} \right) \right) \end{eqnarray*}" src="form_41.png"/>
</p>
<p> for the final integral being between <img class="formulaInl" alt="$[0, \infty]$" src="form_42.png"/>. In these equations we have used the following substitutions: <img class="formulaInl" alt="$d_f = \sum_{i=1}^N d_i f_i$" src="form_31.png"/>, <img class="formulaInl" alt="$d_g = \sum_{i=1}^N d_i g_i$" src="form_32.png"/>, <img class="formulaInl" alt="$d_h = \sum_{i=1}^N d_i h_i$" src="form_33.png"/>, <img class="formulaInl" alt="$f_g = \sum_{i=1}^N f_i g_i$" src="form_34.png"/> <img class="formulaInl" alt="$f_h = \sum_{i=1}^N f_i h_i$" src="form_35.png"/>, <img class="formulaInl" alt="$g_h = \sum_{i=1}^N g_i h_i$" src="form_36.png"/>, <img class="formulaInl" alt="$F = \sum_{i=1}^N f_i^2$" src="form_37.png"/>, <img class="formulaInl" alt="$G = \sum_{i=1}^N g_i^2$" src="form_38.png"/>, and <img class="formulaInl" alt="$H = \sum_{i=1}^N H_i^2$" src="form_39.png"/> where <img class="formulaInl" alt="$d$" src="form_26.png"/> is the data and <img class="formulaInl" alt="$f$" src="form_22.png"/>, <img class="formulaInl" alt="$g$" src="form_23.png"/> and <img class="formulaInl" alt="$h$" src="form_24.png"/> are the three model components for which the amplitudes have been marginalised over.</p>
<p>This function explicitly writes out the marginalised likelihood ratio for a model consisting of three components with the amplitudes marginalised over. This can be used to test the correctness of the <code><a class="el" href="ampmarginaliser_8h.html#a0866718fbad645ebe568f10ac108470f" title="Marginalise a Gaussian likelihood ratio over the amplitudes for each of a set of model components...">marginalise_amplitudes()</a></code> function. </p>

</div>
</div>
<a class="anchor" id="a5fa96fe701a1d244b62ddcc51a316a5c"></a><!-- doxytag: member="ampmarginaliser.h::marginalise_three_amplitudes_exclude_final" ref="a5fa96fe701a1d244b62ddcc51a316a5c" args="(double **modelModel, double *dataModel, double sigma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="ampmarginaliser_8h.html#a5fa96fe701a1d244b62ddcc51a316a5c">marginalise_three_amplitudes_exclude_final</a> </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>modelModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dataModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Explicitly marginalise over the first three model component amplitudes, but not the final one. </p>
<p>This function uses the fully expanded integral over the amplitudes of first three components of a signal model, whilst not integrating over the final fourth component's amplitude. All the amplitude marginalisations are performed over the <img class="formulaInl" alt="${-\infty, \infty}$" src="form_28.png"/> range. This can be used to test the correctness of the <code><a class="el" href="ampmarginaliser_8c.html#a521f5acbf28df7ce261996914f50e5b6" title="Marginalise over all amplitudes except for the final model component.">marginalise_amplitudes_except_final()</a></code> function. </p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 9 2014 10:10:01 for Amplitude Marginaliser by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
